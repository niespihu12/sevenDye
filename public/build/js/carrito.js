document.querySelectorAll(".quantity-btn").forEach((t=>{t.addEventListener("click",(async t=>{const e=t.target.classList.contains("increase"),o=t.target.parentElement.querySelector("input");let n=parseInt(o.value);if(n=e?n+1:n-1,n<1)return;const a=t.target.dataset.clave;try{const t=await fetch("/carrito/actualizar",{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({clave:a,cantidad:n})});(await t.json()).ok&&(o.value=n,window.location.reload())}catch(t){console.error("Error:",t)}}))})),document.querySelectorAll(".cart-item__remove").forEach((t=>{t.addEventListener("click",(async t=>{const e=t.target.closest("button").dataset.clave;try{const o=await fetch("/carrito/eliminar",{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({clave:e})});(await o.json()).ok&&(t.target.closest(".cart-item").remove(),window.location.reload())}catch(t){console.error("Error:",t)}}))}));const applyCuponBtn=document.getElementById("apply-cupon-btn");applyCuponBtn&&applyCuponBtn.addEventListener("click",(async()=>{const t=document.getElementById("cupon-input").value.trim(),e=document.getElementById("cupon-message");if(e.textContent="",e.classList.remove("error","success"),!t)return e.textContent="Please enter a coupon code",void e.classList.add("error");try{const o=await fetch("/carrito/aplicar-cupon",{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({codigo:t})}),n=await o.json();n.ok?(e.textContent=n.mensaje,e.classList.remove("error"),e.classList.add("success"),window.location.reload()):(e.textContent=n.mensaje,e.classList.remove("success"),e.classList.add("error"))}catch(t){console.error("Error:",t),e.textContent="Error applying coupon",e.classList.add("error")}}));const removeCuponBtn=document.getElementById("remove-cupon-btn");removeCuponBtn&&removeCuponBtn.addEventListener("click",(async()=>{try{const t=await fetch("/carrito/quitar-cupon",{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}});(await t.json()).ok&&window.location.reload()}catch(t){console.error("Error:",t)}}));