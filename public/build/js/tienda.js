let currentCategorySlug="",currentMinPrice=0,currentMaxPrice=0,currentColorId=0,isPriceFilterActive=!1,minDbPrice=0,maxDbPrice=0;function initializeVariables(e){currentCategorySlug=e.categoria_slug||"",currentMinPrice=e.precio_min||0,currentMaxPrice=e.precio_max||100,currentColorId=e.color_id||0,isPriceFilterActive=e.filtro_precio_activo||!1,minDbPrice=e.min_db||0,maxDbPrice=e.max_db||100}function applyFilters(){let e=currentCategorySlug?`/tienda/${currentCategorySlug}`:"/tienda",t=[];const n=document.querySelector(".subcategories__item.active")?.dataset.subcategoriaId;n&&t.push(`subcategoria=${n}`);const i=document.getElementById("sortOrder");i&&i.value&&t.push(`orden=${i.value}`),isPriceFilterActive&&(t.push("filtro_precio=1"),t.push(`precio_min=${currentMinPrice}`),t.push(`precio_max=${currentMaxPrice}`)),currentColorId>0&&t.push(`color=${currentColorId}`);const r=window.paginationState?.currentPage||1;r>1&&t.push(`pagina=${r}`),t.length>0&&(e+="?"+t.join("&")),window.location.href=e}function clearFilters(){window.location.href="/tienda"}function updateSliderBackground(e){if(!e)return;const t=(e.value-e.min)/(e.max-e.min)*100;e.style.background=`linear-gradient(to right, var(--primary) ${t}%, #ddd ${t}%)`}function setupFilterDrawer(){const e=document.getElementById("filterToggleBtn"),t=document.getElementById("mobileFilterDrawer"),n=document.getElementById("filterOverlay"),i=document.getElementById("closeDrawer");function r(){t.classList.toggle("active"),n.classList.toggle("active"),document.body.classList.toggle("no-scroll")}e&&e.addEventListener("click",r),i&&i.addEventListener("click",r),n&&n.addEventListener("click",r)}function setupFilterControls(){const e=document.getElementById("priceRange"),t=document.getElementById("priceRangeDisplay"),n=document.getElementById("enablePriceFilter");e&&(e.addEventListener("input",(function(){const e=parseFloat(this.value);if(t){const n=t.textContent.trim().charAt(0)||"$";t.textContent=`${n}${currentMinPrice.toFixed(2)} - ${n}${e.toFixed(2)}`}currentMaxPrice=e,updateSliderBackground(this)})),e.addEventListener("change",(function(){isPriceFilterActive&&applyFilters()})),updateSliderBackground(e)),n&&n.addEventListener("change",(function(){isPriceFilterActive=this.checked,e&&(e.disabled=!isPriceFilterActive,e.parentElement.style.opacity=isPriceFilterActive?"1":"0.5"),isPriceFilterActive||(currentMinPrice=minDbPrice,currentMaxPrice=maxDbPrice),applyFilters()}));const i=document.querySelectorAll(".colors__dot");i.forEach((e=>{e.addEventListener("click",(function(){i.forEach((e=>e.classList.remove("active"))),this.classList.add("active"),currentColorId=parseInt(this.dataset.colorId)||0,applyFilters()}))}));const r=document.getElementById("applyFiltersBtn");r&&r.addEventListener("click",applyFilters);const a=document.getElementById("clearFiltersBtn");a&&a.addEventListener("click",clearFilters);const o=document.getElementById("sortOrder");o&&o.addEventListener("change",(function(){applyFilters()}))}function setupPagination(){let e=1;const t=document.querySelector(".products"),n=document.querySelector(".pagination"),i=document.querySelector(".results-count span");if(!t||!n)return;const r=Array.from(t.querySelectorAll(".products__card")),a=r.length;function o(t){e=t,window.paginationState.currentPage=t;const o=15*(t-1),c=Math.min(o+15,a);r.forEach((e=>{e.style.display="none"}));for(let e=o;e<c;e++)r[e]&&(r[e].style.display="flex");n.querySelectorAll(".pagination__number").forEach(((e,n)=>{e.classList.toggle("active",n+1===t)})),i&&(i.textContent=`Mostrando ${Math.min(15,c-o)} de ${a} productos`),document.querySelector(".products-section").scrollIntoView({behavior:"smooth",block:"start"})}window.paginationState={currentPage:1,totalPages:Math.ceil(a/15)},function(){if(document.getElementById("pagination-styles"))return;const e=document.createElement("style");e.id="pagination-styles",e.textContent="\n            .pagination {\n                display: flex;\n                justify-content: center;\n                align-items: center;\n                margin-top: 2rem;\n                gap: 0.5rem;\n            }\n            \n            .pagination__number, .pagination__arrow {\n                display: flex;\n                justify-content: center;\n                align-items: center;\n                width: 2.5rem;\n                height: 2.5rem;\n                border-radius: 50%;\n                cursor: pointer;\n                transition: all 0.3s ease;\n                font-weight: 500;\n            }\n            \n            .pagination__number:hover, .pagination__arrow:hover {\n                background-color: var(--primary-light);\n                color: var(--dark);\n            }\n            \n            .pagination__number.active {\n                background-color: var(--primary);\n                color: white;\n            }\n            \n            .pagination__arrow {\n                font-size: 1.2rem;\n                user-select: none;\n            }\n            \n            @media (max-width: 768px) {\n                .pagination__number, .pagination__arrow {\n                    width: 2rem;\n                    height: 2rem;\n                    font-size: 0.9rem;\n                }\n            }\n        ",document.head.appendChild(e)}(),function(){const t=Math.ceil(a/15);if(window.paginationState.totalPages=t,t<=1)return void(n.style.display="none");n.innerHTML="";const i=document.createElement("span");i.className="pagination__arrow",i.innerHTML="&laquo;",i.addEventListener("click",(()=>{e>1&&o(e-1)})),n.appendChild(i);for(let i=1;i<=t;i++){const t=document.createElement("span");t.className="pagination__number "+(i===e?"active":""),t.textContent=i,t.addEventListener("click",(()=>o(i))),n.appendChild(t)}const r=document.createElement("span");r.className="pagination__arrow",r.innerHTML="&raquo;",r.addEventListener("click",(()=>{e<t&&o(e+1)})),n.appendChild(r),o(1)}(),function(){const e=new URLSearchParams(window.location.search);if(e.has("pagina")){const t=parseInt(e.get("pagina"));!isNaN(t)&&t>0&&setTimeout((()=>o(t)),100)}}(),window.paginationSystem={goToPage:o,getCurrentPage:()=>e}}document.addEventListener("DOMContentLoaded",(function(){setupFilterDrawer(),setupFilterControls(),setupPagination()})),window.tiendaSystem={applyFilters:applyFilters,clearFilters:clearFilters,initializeVariables:initializeVariables};